# 解决 Excel 网关文件名乱码问题

## 问题分析

文件名乱码问题主要出现在 Excel 文件上传处理过程中，可能的原因包括：
1. 字符编码不一致
2. 文件名处理逻辑问题
3. 服务间通信时的编码转换问题

## 解决方案

### 1. 修改 `excelInterceptor.js` 文件

#### 1.1 添加文件名处理函数
- 在文件顶部添加 `sanitizeFilename` 函数，确保文件名正确编码
- 该函数将处理可能的编码问题，确保文件名在整个流程中保持一致

#### 1.2 改进文件扩展名替换逻辑
- 替换当前的正则表达式方式，使用更可靠的字符串操作方法
- 确保无论文件名格式如何，都能正确替换为 `.md` 扩展名

#### 1.3 在关键位置应用文件名处理
- 在调用 `preprocessExcel` 函数时使用处理后的文件名
- 在生成新的 Markdown 文件名时使用处理后的文件名

### 2. 验证修改

- 重启网关服务和预处理服务
- 上传带有中文文件名的 Excel 文件
- 检查生成的 Markdown 文件名是否正确
- 验证文件内容是否正确处理

## 预期结果

- 文件名不再出现乱码
- 中文文件名能正确显示和处理
- 整个上传和处理流程正常运行

## 修改文件

- `admin-gateway/src/excelInterceptor.js`